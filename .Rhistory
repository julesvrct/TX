{
for ( j in 1:length((split(X[[i]], cumsum (X[[i]]$mode == 10)))))
{
trips[[j]] = split(X[[i]], cumsum (X[[i]]$mode == 10))[[j]]
}
}
for (j in 1:length(trips)) {
trips[[j]]=trips[[j]][-1,]
}
info_trips = data.frame(id=c(1:length(trips)), mean_speed=NA) #autres global features Ã  rajouter dans le data.frame.
trips_speeds = list(vector())
index = 0
for (t in trips)
{
index = index + 1
v = vector()
for (i in 1:(length(t$id)-1))
{
v = c(v,vitesse_UTM(t[i,],t[i+1,]))
}
trips_speeds[[index]] = v
}
for (i in 1:nrow(info_trips))
{
info_trips[i,2] = sum(trips_speeds[[i]])/length(trips_speeds[[i]])
}
trips[[146]]
trips[[14]]
trips_speeds[[14]]
#trips_speeds[[146]]
#[1] 806.1009   0.0000   0.0000
for (t in trips)
{
t[1,]
}
#trips_speeds[[146]]
#[1] 806.1009   0.0000   0.0000
for (t in trips)
{
print(t[1,])
}
trips[[1]]
length(t$id)
#trips_speeds[[146]]
#[1] 806.1009   0.0000   0.0000
for (t in trips)
{
print(t)
}
#trips_speeds[[146]]
#[1] 806.1009   0.0000   0.0000
i=0
#trips_speeds[[146]]
#[1] 806.1009   0.0000   0.0000
i=0
for (t in trips)
{ i++
print(t)
}
i
#trips_speeds[[146]]
#[1] 806.1009   0.0000   0.0000
i=0
for (t in trips)
{ i=i+1
print(t)
}
i
trips<-list(data.frame())
for(i in 1:length(X))
{
for ( j in 1:length((split(X[[i]], cumsum (X[[i]]$mode == 10)))))
{
trips[[j]] = split(X[[i]], cumsum (X[[i]]$mode == 10))[[j]]
}
}
for (j in 1:length(trips)) {
trips[[j]]=trips[[j]][-1,]
}
info_trips = data.frame(id=c(1:length(trips)), mean_speed=NA) #autres global features Ã  rajouter dans le data.frame.
trips_speeds = list(vector())
index = 0
for (t in trips)
{
index = index + 1
v = vector()
for (i in 1:(length(t$id)-1))
{
v = c(v,vitesse_UTM(t[i,],t[i+1,]))
}
if(vitesse_UTM(t[i,],t[i+1,])>120)
{
trips[[index]]=trips[[index]][-i,]
}
else
{
trips_speeds[[index]] = v
}
}
,vitesse_UTM(t[i,],t[i+1,])
,vitesse_UTM(t[[15][i,],t[i+1,])
vitesse_UTM(t[[15][i,],t[i+1,])
vitesse_UTM(trips[[15]][1,],trips[[15]][2,])
vitesse_UTM(trips[[15]][1,],trips[[15]][2,])>120
vitesse_UTM(trips[[15]][1,],trips[[15]][2,])<120
trips_speeds = list(vector())
index = 0
for (t in trips)
{
index = index + 1
v = vector()
for (i in 1:(length(t$id)-1))
{
v = c(v,vitesse_UTM(t[i,],t[i+1,]))
}
if(vitesse_UTM(t[i,],t[i+1,])>120)
{
trips[[index]]=trips[[index]][-i,]
}
else
{
trips_speeds[[index]] = v
}
}
trips_speeds = list(vector())
index = 0
for (t in trips)
{
index = index + 1
v = vector()
for (i in 1:(length(t$id)-1))
{
v = c(v,vitesse_UTM(t[i,],t[i+1,]))
}
if(is.null(vitesse_UTM(t[i,],t[i+1,])) && vitesse_UTM(t[i,],t[i+1,]) >120)
{
trips[[index]]=trips[[index]][-i,]
}
else
{
trips_speeds[[index]] = v
}
}
vitesse_UTM(trips[[15]][1,],trips[[15]][2,])
#trips_speeds[[146]]
#[1] 806.1009   0.0000   0.0000
k=0
trips[[146]]
trips_speeds = list(vector())
index = 0
for (t in trips)
{
index = index + 1
v = vector()
for (i in 1:(length(t$id)-1))
{
v = c(v,vitesse_UTM(t[i,],t[i+1,]))
}
if(is.null(vitesse_UTM(t[i,],t[i+1,])) || vitesse_UTM(t[i,],t[i+1,]) >120)
{
trips[[index]]=trips[[index]][-i,]
}
else
{
trips_speeds[[index]] = v
}
}
trips_speeds = list(vector())
index = 0
for (t in trips)
{
index = index + 1
v = vector()
for (i in 1:(length(t$id)-1))
{
v = c(v,vitesse_UTM(t[i,],t[i+1,]))
}
if(is.null(vitesse_UTM(t[i,],t[i+1,])))
{
trips[[index]]=trips[[index]][-i,]
}
else if(vitesse_UTM(t[i,],t[i+1,]) >120)
{
trips[[index]]=trips[[index]][-i,]
}
else
{
trips_speeds[[index]] = v
}
}
trips[[146]]
vitesse_UTM(trips[[1]][1,],trips[[1]][2,])
vitesse_UTM(trips[[1]][1,],trips[[1]][2,])>120
vitesse_UTM(trips[[1]][4,],trips[[1]][5,])>120
vitesse_UTM(trips[[2]][4,],trips[[2]][5,])>120
trips[[2]][4,]
trips[[2]]
trips_speeds = list(vector())
trips<-list(data.frame())
for(i in 1:length(X))
{
for ( j in 1:length((split(X[[i]], cumsum (X[[i]]$mode == 10)))))
{
trips[[j]] = split(X[[i]], cumsum (X[[i]]$mode == 10))[[j]]
}
}
for (j in 1:length(trips)) {
trips[[j]]=trips[[j]][-1,]
}
info_trips = data.frame(id=c(1:length(trips)), mean_speed=NA) #autres global features Ã  rajouter dans le data.frame.
trips_speeds = list(vector())
index = 0
for (t in trips)
{ val==0
index = index + 1
v = vector()
for (i in 1:(length(t$id)-1))
{
if(is.null(vitesse_UTM(t[i,],t[i+1,])))
{
trips[[index]]=trips[[index]][-i,]
}
else if(vitesse_UTM(t[i,],t[i+1,]) >120)
{
trips[[index]]=trips[[index]][-i,]
}
else
{
val=1
v = c(v,vitesse_UTM(t[i,],t[i+1,]))
}
}
if(val==1)
{
trips_speeds[[index]] = v
}
}
info_trips = data.frame(id=c(1:length(trips)), mean_speed=NA) #autres global features Ã  rajouter dans le data.frame.
trips_speeds = list(vector())
index = 0
for (t in trips)
{
index = index + 1
v = vector()
for (i in 1:(length(t$id)-1))
{
if(is.null(vitesse_UTM(t[i,],t[i+1,])))
{
trips[[index]]=trips[[index]][-i,]
}
else if(vitesse_UTM(t[i,],t[i+1,]) >120)
{
trips[[index]]=trips[[index]][-i,]
}
else
{
v = c(v,vitesse_UTM(t[i,],t[i+1,]))
}
}
trips_speeds[[index]] = v
}
trips<-list(data.frame())
for(i in 1:length(X))
{
for ( j in 1:length((split(X[[i]], cumsum (X[[i]]$mode == 10)))))
{
trips[[j]] = split(X[[i]], cumsum (X[[i]]$mode == 10))[[j]]
}
}
for (j in 1:length(trips)) {
trips[[j]]=trips[[j]][-1,]
}
info_trips = data.frame(id=c(1:length(trips)), mean_speed=NA) #autres global features Ã  rajouter dans le data.frame.
trips_speeds = list(vector())
index = 0
for (t in trips)
{
index = index + 1
v = vector()
for (i in 1:(length(t$id)-1))
{
if(is.null(vitesse_UTM(t[i,],t[i+1,])))
{
trips[[index]]=trips[[index]][-i,]
}
else if(vitesse_UTM(t[i,],t[i+1,]) >120)
{
trips[[index]]=trips[[index]][-i,]
}
else
{
v = c(v,vitesse_UTM(t[i,],t[i+1,]))
}
}
trips_speeds[[index]] = v
}
trips<-list(data.frame())
for(i in 1:length(X))
{
for ( j in 1:length((split(X[[i]], cumsum (X[[i]]$mode == 10)))))
{
trips[[j]] = split(X[[i]], cumsum (X[[i]]$mode == 10))[[j]]
}
}
for (j in 1:length(trips)) {
trips[[j]]=trips[[j]][-1,]
}
info_trips = data.frame(id=c(1:length(trips)), mean_speed=NA) #autres global features Ã  rajouter dans le data.frame.
trips_speeds = list(vector())
index = 0
for (t in trips)
{
index = index + 1
v = vector()
for (i in 1:(length(t$id)-1))
{
if(is.null(vitesse_UTM(t[i,],t[i+1,])))
{
trips[[index]]=trips[[index]][-i,]
}
else if(!is.na(vitesse_UTM(t[i,],t[i+1,])) && vitesse_UTM(t[i,],t[i+1,]) >120)
{
trips[[index]]=trips[[index]][-i,]
}
else
{
v = c(v,vitesse_UTM(t[i,],t[i+1,]))
}
}
trips_speeds[[index]] = v
}
trips_speeds = list(vector())
index = 0
for (t in trips)
{
index = index + 1
v = vector()
for (i in 1:(length(t$id)-1))
{
print(index)
if(is.null(vitesse_UTM(t[i,],t[i+1,])))
{
trips[[index]]=trips[[index]][-i,]
}
else if(!is.na(vitesse_UTM(t[i,],t[i+1,])) && vitesse_UTM(t[i,],t[i+1,]) >120)
{
trips[[index]]=trips[[index]][-i,]
}
else
{
v = c(v,vitesse_UTM(t[i,],t[i+1,]))
}
}
trips_speeds[[index]] = v
}
vitesse_UTM(trips[[5]][2,],trips[[5]][3,])>120
vitesse_UTM(trips[[5]][2,],trips[[5]][3,])>120
trips[[5]]
length(trips[[5]])
dim(trips[[5]])
dim(trips[[5]])[0]
dim(trips[[5]])[1]
trips_speeds = list(vector())
index = 0
for (t in trips)
{
index = index + 1
v = vector()
for (i in 1:(length(t$id)-1))
{
print(index)
if(is.null(vitesse_UTM(t[i,],t[i+1,])))
{
trips[[index]]=trips[[index]][-i,]
}
else if(dim(t)[1]<2)
{
trips[[index]]=trips[[index]][-i,]
}
else if(!is.na(vitesse_UTM(t[i,],t[i+1,])) && vitesse_UTM(t[i,],t[i+1,]) >120)
{
trips[[index]]=trips[[index]][-i,]
}
else
{
v = c(v,vitesse_UTM(t[i,],t[i+1,]))
}
}
trips_speeds[[index]] = v
}
vitesse_UTM(trips[[2]][4,],trips[[2]][5,])>120
trips
trips_speeds[[146]]
#trips_speeds[[146]]
#[1] 806.1009   0.0000   0.0000
k=0
for (t in trips)
{ i=i+1
print(t)
}
for (i in 1:nrow(info_trips))
{
info_trips[i,2] = sum(trips_speeds[[i]])/length(trips_speeds[[i]])
}
plot(info_trips$id,info_trips$mean_speed)
box = boxplot(info_trips$mean_speed)
for (i in 1:nrow(info_trips))
{
info_trips[i,2] = sum(trips_speeds[[i]])/length(trips_speeds[[i]])
}
plot(info_trips$id,info_trips$mean_speed)
summary(info_trips)
#compiegne_data = compiegne_data[c("id","date","X","Y","mode","transportation_mode")]
X <- split(compiegne_data, compiegne_data$id, drop=TRUE)
trips<-list(data.frame())
for(i in 1:length(X))
{
for ( j in 1:length((split(X[[i]], cumsum (X[[i]]$mode == 10)))))
{
trips[[j]] = split(X[[i]], cumsum (X[[i]]$mode == 10))[[j]]
}
}
for (j in 1:length(trips)) {
trips[[j]]=trips[[j]][-1,]
}
info_trips = data.frame(id=c(1:length(trips)), mean_speed=NA) #autres global features Ã  rajouter dans le data.frame.
trips_speeds = list(vector())
index = 0
for (t in trips)
{
index = index + 1
v = vector()
for (i in 1:(length(t$id)-1))
{
print(index)
if(is.null(vitesse_UTM(t[i,],t[i+1,])) || vitesse_UTM(t[i,],t[i+1,])==0 )
{
trips[[index]]=trips[[index]][-i,]
}
else if(dim(t)[1]<2)
{
trips[[index]]=trips[[index]][-i,]
}
else if(!is.na(vitesse_UTM(t[i,],t[i+1,])) && vitesse_UTM(t[i,],t[i+1,]) >120)
{
trips[[index]]=trips[[index]][-i,]
}
else
{
v = c(v,vitesse_UTM(t[i,],t[i+1,]))
}
}
trips_speeds[[index]] = v
}
trips<-list(data.frame())
for(i in 1:length(X))
{
for ( j in 1:length((split(X[[i]], cumsum (X[[i]]$mode == 10)))))
{
trips[[j]] = split(X[[i]], cumsum (X[[i]]$mode == 10))[[j]]
}
}
for (j in 1:length(trips)) {
trips[[j]]=trips[[j]][-1,]
}
info_trips = data.frame(id=c(1:length(trips)), mean_speed=NA) #autres global features Ã  rajouter dans le data.frame.
trips_speeds = list(vector())
index = 0
for (t in trips)
{
index = index + 1
v = vector()
for (i in 1:(length(t$id)-1))
{
print(index)
if(is.null(vitesse_UTM(t[i,],t[i+1,]))  )
{
trips[[index]]=trips[[index]][-i,]
}
else if(dim(t)[1]<2)
{
trips[[index]]=trips[[index]][-i,]
}
else if((!is.na(vitesse_UTM(t[i,],t[i+1,])) && vitesse_UTM(t[i,],t[i+1,]) >120 )|| vitesse_UTM(t[i,],t[i+1,])==0)
{
trips[[index]]=trips[[index]][-i,]
}
else
{
v = c(v,vitesse_UTM(t[i,],t[i+1,]))
}
}
trips_speeds[[index]] = v
}
vitesse_UTM(trips[[2]][4,],trips[[2]][5,])>120
trips[[2]]
trips[[146]]
#trips_speeds[[146]]
#[1] 806.1009   0.0000   0.0000
k=0
for (t in trips)
{ i=i+1
print(t)
}
for (i in 1:nrow(info_trips))
{
info_trips[i,2] = sum(trips_speeds[[i]])/length(trips_speeds[[i]])
}
plot(info_trips$id,info_trips$mean_speed)
box = boxplot(info_trips$mean_speed)
plot(info_trips$id,info_trips$mean_speed)
summary(info_trips)
